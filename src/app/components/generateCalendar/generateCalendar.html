<div class="upload-container">
  <div class="form-group">
    <div class="config-header">
      <label for="configSelect">{{ 'calendar.configLabel' | translate }}</label>
      <button
        type="button"
        (click)="refreshConfig()"
        [disabled]="configLoading()"
        class="refresh-config-btn"
        title="Actualizar opciones de configuraci√≥n">
        @if (configLoading()) {
          üîÑ
        } @else {
          ‚ü≥
        }
      </button>
    </div>

    <select
      id="configSelect"
      [(ngModel)]="selectedConfig"
      class="form-control"
      [disabled]="configLoading() || configOptions().length === 0">
      <option value="">
        @if (configLoading()) {
          Cargando opciones...
        } @else if (configOptions().length === 0) {
          No hay opciones disponibles
        } @else {
          {{ 'calendar.selectConfig' | translate }}
        }
      </option>
      @for (config of configOptions(); track config.value) {
        <option [value]="config.value">
          {{ config.labelKey | translate }}
        </option>
      }
    </select>
  </div>

  <div class="form-group">
    <label for="excelFile">{{ 'calendar.excelLabel' | translate }}</label>
    <input
      id="excelFile"
      type="file"
      accept=".xlsx,.xls"
      (change)="onFileChange($event, 'excel')"
      class="form-control">
    @if (!excelFile()) {
      <small class="help-text">{{ 'calendar.noFileSelected' | translate }}</small>
    }
    @if (excelFile()) {
      <small class="file-selected">‚úì {{ excelFile()?.name }}</small>
    }
  </div>

  <button
    (click)="generateCalendar()"
    [disabled]="loading() || configLoading() || !selectedConfig() || !excelFile() || configOptions().length === 0"
    class="generate-button">
    @if (loading()) {
      {{ 'calendar.loading' | translate }}
    } @else {
      {{ 'calendar.generateButton' | translate }}
    }
  </button>

  <!-- Informaci√≥n adicional sobre el estado -->
  <div class="generation-info">
    @if (configLoading()) {
      <small class="info-text">
        üîÑ Cargando opciones de configuraci√≥n...
      </small>
    }
    @if (!configLoading() && configOptions().length === 0) {
      <small class="warning-text">
        ‚ö†Ô∏è No se pueden generar calendarios sin opciones de configuraci√≥n v√°lidas
      </small>
    }
  </div>

  @if (error()) {
    <div class="error">{{ error() }}</div>
  }
  @if (success()) {
    <div class="success">{{ success() }}</div>
  }
</div>
